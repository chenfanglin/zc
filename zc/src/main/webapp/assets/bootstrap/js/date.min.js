function pickerDateRange(B,C){var G={aToday:"aToday",aYesterday:"aYesterday",aRecent7Days:"aRecent7Days",aRecent14Days:"aRecent14Days",aRecent30Days:"aRecent30Days",aRecent90Days:"aRecent90Days",startDate:"",endDate:"",startCompareDate:"",endCompareDate:"",minValidDate:"315507600",maxValidDate:"",success:function(H){return true},startDateId:"startDate",startCompareDateId:"startCompareDate",endDateId:"endDate",endCompareDateId:"endCompareDate",target:"",needCompare:false,suffix:"",inputTrigger:"input_trigger",compareTrigger:"compare_trigger",compareCheckboxId:"needCompare",calendars:2,dayRangeMax:0,monthRangeMax:12,dateTable:"dateRangeDateTable",selectCss:"dateRangeSelected",compareCss:"dateRangeCompare",coincideCss:"dateRangeCoincide",firstCss:"first",lastCss:"last",clickCss:"today",disableGray:"dateRangeGray",isToday:"dateRangeToday",joinLineId:"joinLine",isSingleDay:false,defaultText:" 至 ",singleCompare:false,stopToday:true,isTodayValid:false,weekendDis:false,disCertainDay:[],disCertainDate:[],shortOpr:false,noCalendar:false,theme:"gri",magicSelect:false,autoCommit:false,autoSubmit:false,replaceBtn:"btn_compare"};var D=this;this.inputId=B;this.inputCompareId=B+"Compare";this.compareInputDiv="div_compare_"+B;this.mOpts=$.extend({},G,C);this.mOpts.calendars=Math.min(this.mOpts.calendars,3);this.mOpts.compareCss=this.mOpts.theme=="ta"?this.mOpts.selectCss:this.mOpts.compareCss;this.periodObj={};this.periodObj[D.mOpts.aToday]=0;this.periodObj[D.mOpts.aYesterday]=1;this.periodObj[D.mOpts.aRecent7Days]=6;this.periodObj[D.mOpts.aRecent14Days]=13;this.periodObj[D.mOpts.aRecent30Days]=29;this.periodObj[D.mOpts.aRecent90Days]=89;this.startDefDate="";var F=""==this.mOpts.suffix?(new Date()).getTime():this.mOpts.suffix;this.calendarId="calendar_"+F;this.dateListId="dateRangePicker_"+F;this.dateRangeCompareDiv="dateRangeCompareDiv_"+F;this.dateRangeDiv="dateRangeDiv_"+F;this.compareCheckBoxDiv="dateRangeCompareCheckBoxDiv_"+F;this.submitBtn="submit_"+F;this.closeBtn="closeBtn_"+F;this.preMonth="dateRangePreMonth_"+F;this.nextMonth="dateRangeNextMonth_"+F;this.startDateId=this.mOpts.startDateId+"_"+F;this.endDateId=this.mOpts.endDateId+"_"+F;this.compareCheckboxId=this.mOpts.compareCheckboxId+"_"+F;this.startCompareDateId=this.mOpts.startCompareDateId+"_"+F;this.endCompareDateId=this.mOpts.endCompareDateId+"_"+F;var A={gri:['<div id="'+this.calendarId+'" class="gri_dateRangeCalendar">','<table class="gri_dateRangePicker"><tr id="'+this.dateListId+'"></tr></table>','<div class="gri_dateRangeOptions" '+(this.mOpts.autoSubmit?' style="display:none" ':"")+">",'<div class="gri_dateRangeInput" id="'+this.dateRangeDiv+'" >','<input type="text" class="gri_dateRangeInput" name="'+this.startDateId+'" id="'+this.startDateId+'" value="'+this.mOpts.startDate+'" readonly />','<span id="'+this.mOpts.joinLineId+'"> - </span>','<input type="text" class="gri_dateRangeInput" name="'+this.endDateId+'" id="'+this.endDateId+'" value="'+this.mOpts.endDate+'" readonly /><br />',"</div>",'<div class="gri_dateRangeInput" id="'+this.dateRangeCompareDiv+'">','<input type="text" class="gri_dateRangeInput" name="'+this.startCompareDateId+'" id="'+this.startCompareDateId+'" value="'+this.mOpts.startCompareDate+'" readonly />','<span class="'+this.mOpts.joinLineId+'"> - </span>','<input type="text" class="gri_dateRangeInput" name="'+this.endCompareDateId+'" id="'+this.endCompareDateId+'" value="'+this.mOpts.endCompareDate+'" readonly />',"</div>","<div>",'<input type="button" name="'+this.submitBtn+'" id="'+this.submitBtn+'" value="确定" />','&nbsp;<a id="'+this.closeBtn+'" href="javascript:;">关闭</a>',"</div>","</div>","</div>"],ta:['<div id="'+this.calendarId+'" class="ta_calendar ta_calendar2 cf">','<div class="ta_calendar_cont cf" id="'+this.dateListId+'">',"</div>",'<div class="ta_calendar_footer cf" '+(this.mOpts.autoSubmit?' style="display:none" ':"")+">",'<div class="frm_msg">','<div id="'+this.dateRangeDiv+'">','<input type="text" class="ta_ipt_text_s" name="'+this.startDateId+'" id="'+this.startDateId+'" value="'+this.mOpts.startDate+'" readonly />','<span class="'+this.mOpts.joinLineId+'"> - </span>','<input type="text" class="ta_ipt_text_s" name="'+this.endDateId+'" id="'+this.endDateId+'" value="'+this.mOpts.endDate+'" readonly /><br />',"</div>",'<div id="'+this.dateRangeCompareDiv+'">','<input type="text" class="ta_ipt_text_s" name="'+this.startCompareDateId+'" id="'+this.startCompareDateId+'" value="'+this.mOpts.startCompareDate+'" readonly />','<span class="'+this.mOpts.joinLineId+'"> - </span>','<input type="text" class="ta_ipt_text_s" name="'+this.endCompareDateId+'" id="'+this.endCompareDateId+'" value="'+this.mOpts.endCompareDate+'" readonly />',"</div>","</div>",'<div class="frm_btn">','<input class="ta_btn ta_btn_primary" type="button" name="'+this.submitBtn+'" id="'+this.submitBtn+'" value="确定" />','<input class="ta_btn" type="button" id="'+this.closeBtn+'" value="取消"/>',"</div>","</div>","</div>"]};var E={gri:['<label class="gri_contrast" for ="'+this.compareCheckboxId+'">','<input type="checkbox" class="gri_pc" name="'+this.compareCheckboxId+'" id="'+this.compareCheckboxId+'" value="1"/>对比',"</label>",'<input type="text" name="'+this.inputCompareId+'" id="'+this.inputCompareId+'" value="" class="gri_date"/>'],ta:['<label class="contrast" for ="'+this.compareCheckboxId+'">','<input type="checkbox" class="pc" name="'+this.compareCheckboxId+'" id="'+this.compareCheckboxId+'" value="1"/>对比',"</label>",'<div class="ta_date" id="'+this.compareInputDiv+'">','	<span name="dateCompare" id="'+this.inputCompareId+'" class="date_title"></span>','	<a class="opt_sel" id="'+this.mOpts.compareTrigger+'" href="#">','		<i class="i_orderd"></i>',"	</a>","</div>"]};if(this.mOpts.theme=="ta"){$(E[this.mOpts.theme].join("")).insertAfter($("#div_"+this.inputId))}else{$(E[this.mOpts.theme].join("")).insertAfter($("#"+this.inputId))}if(this.mOpts.noCalendar){$("#"+this.inputId).css("display","none");$("#"+this.compareCheckboxId).parent().css("display","none")}$(0<$("#appendParent").length?"#appendParent":document.body).append(A[this.mOpts.theme].join(""));$("#"+this.calendarId).css("z-index",9999);if(1>$("#"+this.mOpts.startDateId).length){$(""!=this.mOpts.target?"#"+this.mOpts.target:"body").append('<input type="hidden" id="'+this.mOpts.startDateId+'" name="'+this.mOpts.startDateId+'" value="'+this.mOpts.startDate+'" />')}else{$("#"+this.mOpts.startDateId).val(this.mOpts.startDate)}if(1>$("#"+this.mOpts.endDateId).length){$(""!=this.mOpts.target?"#"+this.mOpts.target:"body").append('<input type="hidden" id="'+this.mOpts.endDateId+'" name="'+this.mOpts.endDateId+'" value="'+this.mOpts.endDate+'" />')}else{$("#"+this.mOpts.endDateId).val(this.mOpts.endDate)}if(1>$("#"+this.mOpts.compareCheckboxId).length){$(""!=this.mOpts.target?"#"+this.mOpts.target:"body").append('<input type="checkbox" id="'+this.mOpts.compareCheckboxId+'" name="'+this.mOpts.compareCheckboxId+'" value="0" style="display:none;" />')}if(false==this.mOpts.needCompare){$("#"+this.compareInputDiv).css("display","none");$("#"+this.compareCheckBoxDiv).css("display","none");$("#"+this.dateRangeCompareDiv).css("display","none");$("#"+this.compareCheckboxId).attr("disabled",true);$("#"+this.startCompareDateId).attr("disabled",true);$("#"+this.endCompareDateId).attr("disabled",true);$("#"+this.compareCheckboxId).parent().css("display","none");$("#"+this.mOpts.replaceBtn).length>0&&$("#"+this.mOpts.replaceBtn).hide()}else{if(1>$("#"+this.mOpts.startCompareDateId).length){$(""!=this.mOpts.target?"#"+this.mOpts.target:"body").append('<input type="hidden" id="'+this.mOpts.startCompareDateId+'" name="'+this.mOpts.startCompareDateId+'" value="'+this.mOpts.startCompareDate+'" />')}else{$("#"+this.mOpts.startCompareDateId).val(this.mOpts.startCompareDate)}if(1>$("#"+this.mOpts.endCompareDateId).length){$(""!=this.mOpts.target?"#"+this.mOpts.target:"body").append('<input type="hidden" id="'+this.mOpts.endCompareDateId+'" name="'+this.mOpts.endCompareDateId+'" value="'+this.mOpts.endCompareDate+'" />')}else{$("#"+this.mOpts.endCompareDateId).val(this.mOpts.endCompareDate)}if(""==this.mOpts.startCompareDate||""==this.mOpts.endCompareDate){$("#"+this.compareCheckboxId).attr("checked",false);$("#"+this.mOpts.compareCheckboxId).attr("checked",false)}else{$("#"+this.compareCheckboxId).attr("checked",true);$("#"+this.mOpts.compareCheckboxId).attr("checked",true)}}this.dateInput=this.startDateId;this.changeInput(this.dateInput);$("#"+this.startDateId).bind("click",function(){if(D.endCompareDateId==D.dateInput){$("#"+D.startCompareDateId).val(D.startDefDate)}D.startDefDate="";D.removeCSS(1);D.changeInput(D.startDateId);return false});$("#"+this.calendarId).bind("click",function(H){H.stopPropagation()});$("#"+this.startCompareDateId).bind("click",function(){if(D.endDateId==D.dateInput){$("#"+D.startDateId).val(D.startDefDate)}D.startDefDate="";D.removeCSS(0);D.changeInput(D.startCompareDateId);return false});$("#"+this.submitBtn).bind("click",function(){D.close(1);D.mOpts.success({"startDate":$("#"+D.mOpts.startDateId).val(),"endDate":$("#"+D.mOpts.endDateId).val(),"needCompare":$("#"+D.mOpts.compareCheckboxId).val(),"startCompareDate":$("#"+D.mOpts.startCompareDateId).val(),"endCompareDate":$("#"+D.mOpts.endCompareDateId).val()});return false});$("#"+this.closeBtn).bind("click",function(){D.close();return false});$("#"+this.inputId).bind("click",function(){D.init();D.show(false,D);return false});$("#"+this.mOpts.inputTrigger).bind("click",function(){D.init();D.show(false,D);return false});$("#"+this.mOpts.compareTrigger).bind("click",function(){D.init(true);D.show(true,D);return false});$("#"+this.inputCompareId).bind("click",function(){D.init(true);D.show(true,D);return false});if(this.mOpts.singleCompare){if(this.mOpts.theme==="ta"){$("#"+D.startDateId).val(D.mOpts.startDate);$("#"+D.endDateId).val(D.mOpts.startDate);$("#"+D.startCompareDateId).val(D.mOpts.startCompareDate);$("#"+D.endCompareDateId).val(D.mOpts.startCompareDate)}else{$("#"+D.startDateId).val(D.mOpts.startDate);$("#"+D.endDateId).val(D.mOpts.startDate);$("#"+D.startCompareDateId).val(D.mOpts.startCompareDate);$("#"+D.endCompareDateId).val(D.mOpts.startCompareDate);$("#"+this.compareCheckboxId).attr("checked",true);$("#"+this.mOpts.compareCheckboxId).attr("checked",true)}}$("#"+this.dateRangeCompareDiv).css("display",$("#"+this.compareCheckboxId).attr("checked")?"":"none");$("#"+this.compareInputDiv).css("display",$("#"+this.compareCheckboxId).attr("checked")?"":"none");$("#"+this.compareCheckboxId).bind("click",function(){$("#"+D.inputCompareId).css("display",this.checked?"":"none");$("#"+D.dateRangeCompareDiv).css("display",this.checked?"":"none");$("#"+D.compareInputDiv).css("display",this.checked?"":"none");$("#"+D.startCompareDateId).css("disabled",this.checked?false:true);$("#"+D.endCompareDateId).css("disabled",this.checked?false:true);$("#"+D.mOpts.compareCheckboxId).attr("checked",$("#"+D.compareCheckboxId).attr("checked"));$("#"+D.mOpts.compareCheckboxId).val($("#"+D.compareCheckboxId).attr("checked")?1:0);if($("#"+D.compareCheckboxId).attr("checked")){sDate=D.str2date($("#"+D.startDateId).val());sTime=sDate.getTime();eDate=D.str2date($("#"+D.endDateId).val());eTime=eDate.getTime();scDate=$("#"+D.startCompareDateId).val();ecDate=$("#"+D.endCompareDateId).val();if(""==scDate||""==ecDate){ecDate=D.str2date(D.date2ymd(sDate).join("-"));ecDate.setDate(ecDate.getDate()-1);scDate=D.str2date(D.date2ymd(sDate).join("-"));scDate.setDate(scDate.getDate()-((eTime-sTime)/86400000)-1);if(ecDate.getTime()<D.mOpts.minValidDate*1000){scDate=sDate;ecDate=eDate}if(ecDate.getTime()>=D.mOpts.minValidDate*1000&&scDate.getTime()<D.mOpts.minValidDate*1000){scDate.setTime(D.mOpts.minValidDate*1000);scDate=D.str2date(D.date2ymd(scDate).join("-"));ecDate.setDate(scDate.getDate()+((eTime-sTime)/86400000)-1)}$("#"+D.startCompareDateId).val(D.formatDate(D.date2ymd(scDate).join("-")));$("#"+D.endCompareDateId).val(D.formatDate(D.date2ymd(ecDate).join("-")))}D.addCSS(1);D.changeInput(D.startCompareDateId)}else{D.removeCSS(1);D.changeInput(D.startDateId)}D.close(1);D.mOpts.success({"startDate":$("#"+D.mOpts.startDateId).val(),"endDate":$("#"+D.mOpts.endDateId).val(),"needCompare":$("#"+D.mOpts.compareCheckboxId).val(),"startCompareDate":$("#"+D.mOpts.startCompareDateId).val(),"endCompareDate":$("#"+D.mOpts.endCompareDateId).val()})});this.init();this.close(1);if(this.mOpts.replaceBtn&&$("#"+this.mOpts.replaceBtn).length>0){$("#"+D.compareCheckboxId).hide();$(".contrast").hide();$("#"+this.mOpts.replaceBtn).bind("click",function(){var H=this;$("#"+D.compareCheckboxId).attr("checked")?$("#"+D.compareCheckboxId).removeAttr("checked"):$("#"+D.compareCheckboxId).attr("checked","checked");$("#"+D.compareCheckboxId).click();$("#"+D.compareCheckboxId).attr("checked")?function(){$("#"+D.compareCheckboxId).removeAttr("checked");$(".contrast").hide();$(H).text("按时间对比")}():function(){$("#"+D.compareCheckboxId).attr("checked","checked");$(".contrast").show();$(H).text("取消对比")}()})}if(this.mOpts.autoCommit){this.mOpts.success({"startDate":$("#"+D.mOpts.startDateId).val(),"endDate":$("#"+D.mOpts.endDateId).val(),"needCompare":$("#"+D.mOpts.compareCheckboxId).val(),"startCompareDate":$("#"+D.mOpts.startCompareDateId).val(),"endCompareDate":$("#"+D.mOpts.endCompareDateId).val()})}$(document).bind("click",function(){D.close()})}pickerDateRange.prototype.init=function(E){var A=this;var J,F;var H=typeof(E)!="undefined"?E&&$("#"+A.compareCheckboxId).attr("checked"):$("#"+A.compareCheckboxId).attr("checked");$("#"+this.dateListId).empty();var C=""==this.mOpts.endDate?(new Date()):this.str2date(this.mOpts.endDate);this.calendar_endDate=new Date(C.getFullYear(),C.getMonth()+1,0);if(this.mOpts.magicSelect&&this.mOpts.theme=="ta"){var G=0;do{var D=null;if(G==0){D=this.fillDate(this.str2date($("#"+this.endDateId).val()).getFullYear(),this.str2date($("#"+this.endDateId).val()).getMonth(),G);$("#"+this.dateListId).append(D)}else{D=this.fillDate(this.str2date($("#"+this.startDateId).val()).getFullYear(),this.str2date($("#"+this.startDateId).val()).getMonth(),G);var I=(this.mOpts.theme=="ta"?$("#"+this.dateListId).find("table").get(0):$("#"+this.dateListId).find("td").get(0));$(I).before(D)}G++}while(G<2);this.calendar_startDate=new Date(this.str2date($("#"+this.startDateId).val()).getFullYear(),this.str2date($("#"+this.startDateId).val()).getMonth(),1)}else{for(var G=0;G<this.mOpts.calendars;G++){var D=null;if(this.mOpts.theme=="ta"){D=this.fillDate(C.getFullYear(),C.getMonth(),G)}else{D=document.createElement("td");$(D).append(this.fillDate(C.getFullYear(),C.getMonth(),G));$(D).css("vertical-align","top")}if(0==G){$("#"+this.dateListId).append(D)}else{var I=(this.mOpts.theme=="ta"?$("#"+this.dateListId).find("table").get(0):$("#"+this.dateListId).find("td").get(0));$(I).before(D)}C.setMonth(C.getMonth()-1,1)}this.calendar_startDate=new Date(C.getFullYear(),C.getMonth()+1,1)}$("#"+this.preMonth).bind("click",function(){A.calendar_endDate.setMonth(A.calendar_endDate.getMonth()-1,1);A.mOpts.endDate=A.date2ymd(A.calendar_endDate).join("-");A.init(E);if(1==A.mOpts.calendars){if(""==$("#"+A.startDateId).val()){A.changeInput(A.startDateId)}else{A.changeInput(A.endDateId)}}return false});$("#"+this.nextMonth).bind("click",function(){A.calendar_endDate.setMonth(A.calendar_endDate.getMonth()+1,1);A.mOpts.endDate=A.date2ymd(A.calendar_endDate).join("-");A.init(E);if(1==A.mOpts.calendars){if(""==$("#"+A.startDateId).val()){A.changeInput(A.startDateId)}else{A.changeInput(A.endDateId)}}return false});if(this.mOpts.magicSelect){this.bindChangeForSelect()}if(this.endDateId!=this.dateInput&&this.endCompareDateId!=this.dateInput){(H&&typeof(E)!="undefined")?this.addCSS(1):this.addCSS(0)}if(H&&typeof(E)!="undefined"){A.addCSS(1)}else{A.addCSS(0)}$("#"+A.inputCompareId).css("display",H?"":"none");$("#"+this.compareInputDiv).css("display",$("#"+this.compareCheckboxId).attr("checked")?"":"none");for(var B in A.periodObj){if($("#"+B).length>0){$("#"+B).unbind("click");$("#"+B).bind("click",function(){var L=A.mOpts.theme=="ta"?"active":"a";$(this).parent().nextAll().removeClass(L);$(this).parent().prevAll().removeClass(L);$(this).parent().addClass(L);var K=A.getSpecialPeriod(A.periodObj[$(this).attr("id")]);$("#"+A.startDateId).val(A.formatDate(K.otherday));$("#"+A.endDateId).val(A.formatDate(K.today));$("#"+A.mOpts.startDateId).val($("#"+A.startDateId).val());$("#"+A.mOpts.endDateId).val($("#"+A.endDateId).val());A.mOpts.theme=="ta"?$("#"+A.compareInputDiv).hide():$("#"+A.inputCompareId).css("display","none");$("#"+A.compareCheckboxId).attr("checked",false);$("#"+A.mOpts.compareCheckboxId).attr("checked",false);$("#"+this.compareInputDiv).css("display",$("#"+this.compareCheckboxId).attr("checked")?"":"none");A.close(1);$("#"+A.startCompareDateId).val("");$("#"+A.endCompareDateId).val("");$("#"+A.mOpts.startCompareDateId).val("");$("#"+A.mOpts.endCompareDateId).val("");$("#"+A.mOpts.compareCheckboxId).val(0);if($("#"+A.mOpts.replaceBtn).length>0){$(".contrast").hide();$("#"+A.mOpts.replaceBtn).text("按时间对比")}A.mOpts.success({"startDate":$("#"+A.mOpts.startDateId).val(),"endDate":$("#"+A.mOpts.endDateId).val(),"needCompare":$("#"+A.mOpts.compareCheckboxId).val(),"startCompareDate":$("#"+A.mOpts.startCompareDateId).val(),"endCompareDate":$("#"+A.mOpts.endCompareDateId).val()})})}}$(document).bind("click",function(){A.close()});$("#"+this.inputId).bind("change",function(){if($(this).val()===""){$("#"+A.startDateId).val("");$("#"+A.endDateId).val("");$("#"+A.startCompareDateId).val("");$("#"+A.endCompareDateId).val("")}})};pickerDateRange.prototype.bindChangeForSelect=function(){var B=this;var C=function(K,G,H,E){E=E||"open";var L=null,I=500;function J(){$("#"+G).removeClass(E)}function F(){$("#"+G).addClass(E)}function D(){return $("#"+G).attr("class")==E}$("#"+K).click(function(){D()?J():F()}).mouseover(function(){clearTimeout(L)}).mouseout(function(){L=setTimeout(J,I)});$("#"+H).mouseover(function(){clearTimeout(L)}).mouseout(function(){L=setTimeout(J,I)})};try{$("#"+this.dateListId).find('div[id*="selected"]').each(function(){var E=$(this).attr("id").match(/(\w+)_(\d)/i);if(E){var F=E[1];var D=E[2];if(F=="yselected"){C("_ybtn_"+D,$(this).attr("id"),"_yctn_"+D)}else{if(F=="mselected"){C("_mbtn_"+D,$(this).attr("id"),"_mctn_"+D)}}$(this).find("li a").each(function(){$(this).click(function(){var I=$(this).parents(".select_wrap").attr("id").match(/(\w+)_(\d)/i);var J=I[1];var K=I[2];var H=null;if(K^1==0){if(J=="yselected"){B.calendar_startDate.setYear($(this).text()*1,1)}else{if(J="mselected"){B.calendar_startDate.setMonth($(this).text()*1-1,1)}}B.mOpts.startDate=B.date2ymd(B.calendar_startDate).join("-");H=B.fillDate(B.calendar_startDate.getFullYear(),B.calendar_startDate.getMonth(),K)}else{if(J=="yselected"){B.calendar_endDate.setYear($(this).text()*1,1)}else{if(J="mselected"){B.calendar_endDate.setMonth($(this).text()*1-1,1)}}B.mOpts.endDate=B.date2ymd(B.calendar_endDate).join("-");H=B.fillDate(B.calendar_endDate.getFullYear(),B.calendar_endDate.getMonth(),K)}var G=$("#"+B.dateListId).find("table").get(K^1);$(G).replaceWith(H);B.removeCSS(0);B.bindChangeForSelect()})})}})}catch(A){window.console&&console.log(A)}};pickerDateRange.prototype.getSpecialPeriod=function(B){var C=this;var E=new Date();(true==C.mOpts.isTodayValid&&(""!=C.mOpts.isTodayValid)||2>B)?"":E.setTime(E.getTime()-(1*24*60*60*1000));var F=((E.getTime()-(B*24*60*60*1000))<(C.mOpts.minValidDate*1000))?(C.mOpts.minValidDate*1000):(E.getTime()-(B*24*60*60*1000));var A=E.getFullYear()+"-"+(E.getMonth()+1)+"-"+E.getDate();E.setTime(F);var D=E.getFullYear()+"-"+(E.getMonth()+1)+"-"+E.getDate();if(B==C.periodObj.aYesterday){A=D}return{today:A,otherday:D}};pickerDateRange.prototype.getCurrentDate=function(){return{"startDate":$("#"+this.mOpts.startDateId).val(),"endDate":$("#"+this.mOpts.endDateId).val(),"needCompare":$("#"+this.mOpts.compareCheckboxId).val(),"startCompareDate":$("#"+this.mOpts.startCompareDateId).val(),"endCompareDate":$("#"+this.mOpts.endCompareDateId).val()}};pickerDateRange.prototype.removeCSS=function(G,D){if("undefined"==typeof(D)){D=this.mOpts.theme+"_"+this.mOpts.coincideCss}if("undefined"==typeof(G)){G=0}var C=this.calendar_startDate;var A=this.calendar_endDate;if(this.mOpts.magicSelect){C=this.str2date($("#"+this.startDateId).val());A=this.str2date($("#"+this.endDateId).val())}var F=new Date(C.getFullYear(),C.getMonth(),C.getDate());var E="";for(var B=new Date(F);B.getTime()<=A.getTime();B.setDate(B.getDate()+1)){if(0==G){E=this.mOpts.theme+"_"+this.mOpts.selectCss}else{E=this.mOpts.theme+"_"+this.mOpts.compareCss}$("#"+this.calendarId+"_"+this.date2ymd(B).join("-")).removeClass(E);$("#"+this.calendarId+"_"+this.date2ymd(B).join("-")).removeClass(this.mOpts.firstCss).removeClass(this.mOpts.lastCss).removeClass(this.mOpts.clickCss)}};pickerDateRange.prototype.addCSS=function(F,C){if("undefined"==typeof(C)){C=this.mOpts.theme+"_"+this.mOpts.coincideCss}if("undefined"==typeof(F)){F=0}var E=this.str2date($("#"+this.startDateId).val());var D=this.str2date($("#"+this.endDateId).val());var I=this.str2date($("#"+this.startCompareDateId).val());var A=this.str2date($("#"+this.endCompareDateId).val());var H=0==F?E:I;var G=0==F?D:A;var J="";for(var B=new Date(H);B.getTime()<=G.getTime();B.setDate(B.getDate()+1)){if(0==F){J=this.mOpts.theme+"_"+this.mOpts.selectCss;$("#"+this.calendarId+"_"+this.date2ymd(B).join("-")).removeClass(this.mOpts.firstCss).removeClass(this.mOpts.lastCss).removeClass(this.mOpts.clickCss);$("#"+this.calendarId+"_"+this.date2ymd(B).join("-")).removeClass(J)}else{J=this.mOpts.theme+"_"+this.mOpts.compareCss}$("#"+this.calendarId+"_"+this.date2ymd(B).join("-")).attr("class",J)}if(this.mOpts.theme=="ta"){$("#"+this.calendarId+"_"+this.date2ymd(new Date(H)).join("-")).removeClass().addClass(this.mOpts.firstCss);$("#"+this.calendarId+"_"+this.date2ymd(new Date(G)).join("-")).removeClass().addClass(this.mOpts.lastCss);H.getTime()==G.getTime()&&$("#"+this.calendarId+"_"+this.date2ymd(new Date(G)).join("-")).removeClass().addClass(this.mOpts.clickCss)}};pickerDateRange.prototype.checkDateRange=function(D,H){var F=this.str2date(D);var E=this.str2date(H);var B=F.getTime();var A=E.getTime();var G,C;if(A>=B){C=this.str2date(D);C.setMonth(C.getMonth()+this.mOpts.monthRangeMax);C.setDate(C.getDate()+this.mOpts.dayRangeMax-1);if(C.getTime()<A){alert("结束日期不能大于："+this.date2ymd(C).join("-"));return false}}else{C=this.str2date(H);C.setMonth(C.getMonth()-this.mOpts.monthRangeMax);C.setDate(C.getDate()-this.mOpts.dayRangeMax+1);if(C.getTime()>A){alert("开始日期不能小于："+this.date2ymd(C).join("-"));return false}}return true};pickerDateRange.prototype.selectDate=function(A){this.changeInput(this.dateInput);var B=this.formatDate(A);if(this.startDateId==this.dateInput){this.removeCSS(0);this.removeCSS(1);$("#"+this.calendarId+"_"+A).attr("class",(this.mOpts.theme=="ta"?this.mOpts.clickCss:this.mOpts.theme+"_"+this.mOpts.selectCss));this.startDefDate=$("#"+this.dateInput).val();$("#"+this.dateInput).val(B);if(true==this.mOpts.singleCompare||true==this.mOpts.isSingleDay){this.dateInput=this.startDateId;$("#"+this.endDateId).val(B);(this.mOpts.shortOpr||this.mOpts.autoSubmit)&&this.close(1);this.mOpts.success({"startDate":$("#"+this.mOpts.startDateId).val(),"endDate":$("#"+this.mOpts.endDateId).val(),"needCompare":$("#"+this.mOpts.compareCheckboxId).val(),"startCompareDate":$("#"+this.mOpts.startCompareDateId).val(),"endCompareDate":$("#"+this.mOpts.endCompareDateId).val()})}else{this.dateInput=this.endDateId}}else{if(this.endDateId==this.dateInput){if(""==$("#"+this.startDateId).val()){this.dateInput=this.startDateId;this.selectDate(A);return false}if(false==this.checkDateRange($("#"+this.startDateId).val(),A)){return false}if(-1==this.compareStrDate(A,$("#"+this.startDateId).val())){$("#"+this.dateInput).val($("#"+this.startDateId).val());$("#"+this.startDateId).val(B);B=$("#"+this.dateInput).val()}$("#"+this.dateInput).val(B);this.dateInput=this.startDateId;this.removeCSS(0);this.addCSS(0);this.startDefDate="";if(this.mOpts.autoSubmit){this.close(1);this.mOpts.success({"startDate":$("#"+this.mOpts.startDateId).val(),"endDate":$("#"+this.mOpts.endDateId).val(),"needCompare":$("#"+this.mOpts.compareCheckboxId).val(),"startCompareDate":$("#"+this.mOpts.startCompareDateId).val(),"endCompareDate":$("#"+this.mOpts.endCompareDateId).val()})}}else{if(this.startCompareDateId==this.dateInput){this.removeCSS(1);this.removeCSS(0);$("#"+this.calendarId+"_"+A).attr("class",(this.mOpts.theme=="ta"?this.mOpts.clickCss:this.mOpts.theme+"_"+this.mOpts.compareCss));this.startDefDate=$("#"+this.dateInput).val();$("#"+this.dateInput).val(B);if(true==this.mOpts.singleCompare||true==this.mOpts.isSingleDay){this.dateInput=this.startCompareDateId;$("#"+this.endCompareDateId).val(B);(this.mOpts.shortOpr||this.mOpts.autoSubmit)&&this.close(1);this.mOpts.success({"startDate":$("#"+this.mOpts.startDateId).val(),"endDate":$("#"+this.mOpts.endDateId).val(),"needCompare":$("#"+this.mOpts.compareCheckboxId).val(),"startCompareDate":$("#"+this.mOpts.startCompareDateId).val(),"endCompareDate":$("#"+this.mOpts.endCompareDateId).val()})}else{this.dateInput=this.endCompareDateId}}else{if(this.endCompareDateId==this.dateInput){if(""==$("#"+this.startCompareDateId).val()){this.dateInput=this.startCompareDateId;this.selectDate(A);return false}if(false==this.checkDateRange($("#"+this.startCompareDateId).val(),A)){return false}if(-1==this.compareStrDate(A,$("#"+this.startCompareDateId).val())){$("#"+this.dateInput).val($("#"+this.startCompareDateId).val());$("#"+this.startCompareDateId).val(B);B=$("#"+this.dateInput).val()}$("#"+this.dateInput).val(B);this.dateInput=this.startCompareDateId;this.removeCSS(1);this.addCSS(1);this.startDefDate="";if(this.mOpts.autoSubmit){this.close(1);this.mOpts.success({"startDate":$("#"+this.mOpts.startDateId).val(),"endDate":$("#"+this.mOpts.endDateId).val(),"needCompare":$("#"+this.mOpts.compareCheckboxId).val(),"startCompareDate":$("#"+this.mOpts.startCompareDateId).val(),"endCompareDate":$("#"+this.mOpts.endCompareDateId).val()})}}}}}};pickerDateRange.prototype.show=function(F,E){$("#"+E.dateRangeDiv).css("display",F?"none":"");$("#"+E.dateRangeCompareDiv).css("display",F?"":"none");var D=F?$("#"+this.inputCompareId).offset():$("#"+this.inputId).offset();var C=F?$("#"+this.inputCompareId).height():$("#"+this.inputId).height();var A=parseInt($(document.body)[0].clientWidth);var B=D.left;$("#"+this.calendarId).css("display","block");if(true==this.mOpts.singleCompare||true==this.mOpts.isSingleDay){$("#"+this.endDateId).css("display","none");$("#"+this.endCompareDateId).css("display","none");$("#"+this.mOpts.joinLineId).css("display","none");$("."+this.mOpts.joinLineId).css("display","none")}if(0<A&&$("#"+this.calendarId).width()+D.left>A){B=D.left+$("#"+this.inputId).width()-$("#"+this.calendarId).width()+((/msie/i.test(navigator.userAgent)&&!(/opera/i.test(navigator.userAgent)))?5:0);E.mOpts.theme=="ta"&&(B+=50)}$("#"+this.calendarId).css("left",B+"px");$("#"+this.calendarId).css("top",D.top+(E.mOpts.theme=="ta"?35:22)+"px");F?this.changeInput(this.startCompareDateId):this.changeInput(this.startDateId);return false};pickerDateRange.prototype.close=function(E){var D=this;if(E){if(this.mOpts.shortOpr===true){$("#"+this.inputId).val($("#"+this.startDateId).val());$("#"+this.inputCompareId).val($("#"+this.startCompareDateId).val())}else{$("#"+this.inputId).val($("#"+this.startDateId).val()+(""==$("#"+this.endDateId).val()?"":this.mOpts.defaultText+$("#"+this.endDateId).val()))}var B=((true==this.mOpts.isTodayValid&&""!=this.mOpts.isTodayValid))?new Date().getTime():new Date().getTime()-(1*24*60*60*1000);var K=this.str2date($("#"+this.startDateId).val()).getTime();var A=this.str2date($("#"+this.endDateId).val()).getTime();if(A<K){var G=$("#"+this.startDateId).val();$("#"+this.startDateId).val($("#"+this.endDateId).val());$("#"+this.endDateId).val(G)}var I=this.mOpts.shortOpr==true?$("#"+this.startDateId).val():($("#"+this.startDateId).val()+(""==$("#"+this.endDateId).val()?"":this.mOpts.defaultText+$("#"+this.endDateId).val()));var L=document.getElementById(this.inputId);if(L&&L.tagName=="INPUT"){$("#"+this.inputId).val(I);$("#"+this.inputCompareId).is(":visible")&&$("#"+this.inputCompareId).val(N)}else{$("#"+this.inputId).html(I);$("#"+this.inputCompareId).is(":visible")&&$("#"+this.inputCompareId).html(N)}if(this.mOpts.theme!="ta"){if(""!=$("#"+this.startCompareDateId).val()&&""!=$("#"+this.endCompareDateId).val()){var M=this.str2date($("#"+this.startCompareDateId).val()).getTime();var F=this.str2date($("#"+this.endCompareDateId).val()).getTime();var H=M+A-K;if(H>B){H=B;$("#"+this.startCompareDateId).val(this.formatDate(this.date2ymd(new Date(H+K-A)).join("-")))}$("#"+this.endCompareDateId).val(this.formatDate(this.date2ymd(new Date(H)).join("-")));var M=this.str2date($("#"+this.startCompareDateId).val()).getTime();var F=this.str2date($("#"+this.endCompareDateId).val()).getTime();if(F<M){var G=$("#"+this.startCompareDateId).val();$("#"+this.startCompareDateId).val($("#"+this.endCompareDateId).val());$("#"+this.endCompareDateId).val(G)}}}var N=this.mOpts.shortOpr==true?$("#"+this.startCompareDateId).val():($("#"+this.startCompareDateId).val()+(""==$("#"+this.endCompareDateId).val()?"":this.mOpts.defaultText+$("#"+this.endCompareDateId).val()));if(L&&L.tagName=="INPUT"){$("#"+this.inputCompareId).val(N)}else{$("#"+this.inputCompareId).html(N)}var J=(K-A)/86400000;$("#"+this.mOpts.startDateId).val($("#"+this.startDateId).val());$("#"+this.mOpts.endDateId).val($("#"+this.endDateId).val());$("#"+this.mOpts.startCompareDateId).val($("#"+this.startCompareDateId).val());$("#"+this.mOpts.endCompareDateId).val($("#"+this.endCompareDateId).val());for(var C in this.periodObj){if($("#"+this.mOpts[C])){$("#"+this.mOpts[C]).parent().removeClass("a")}}}$("#"+D.calendarId).css("display","none");return false};pickerDateRange.prototype.fillDate=function(O,V,D){var P=this;var R=this.mOpts.theme=="ta";var H=new Date(O,V,1);var W=new Date(O,V,1);var C=W.getDay();W.setDate(1-C);var E=new Date(O,V+1,0);var I=new Date(O,V+1,0);C=I.getDay();I.setDate(I.getDate()+6-C);var T=new Date();var L=T.getDate();var M=T.getMonth();var Q=T.getFullYear();var G=document.createElement("table");if(R){G.className=this.mOpts.dateTable;cap=document.createElement("caption");if(this.mOpts.magicSelect){var Y=['<div class="select_wrap" id="yselected_'+D+'"><div class="select" id="_ybtn_'+D+'">'+O+'</div><div class="dropdown" id="_yctn_'+D+'"><ul class="list_menu">'];var K=['<div class="select_wrap" id="mselected_'+D+'"><div class="select" id="_mbtn_'+D+'">'+(V+1)+'</div><div class="dropdown" id="_mctn_'+D+'"><ul class="list_menu">'];U=1;yt=Q;do{Y.push('<li><a href="javascript:;">'+(yt--)+"</a></li>");K.push('<li><a href="javascript:;">'+(U++)+"</a></li>")}while(U<=12);Y.push("</ul></div></div>");K.push("</ul></div></div>");$(cap).append(Y.join("")+'<span class="joinLine"> 年 </span>'+K.join("")+'<span class="joinLine"> 月 </span>')}else{$(cap).append(O+"年"+(V+1)+"月")}$(G).append(cap);thead=document.createElement("thead");tr=document.createElement("tr");var B=["日","一","二","三","四","五","六"];for(var U=0;U<7;U++){th=document.createElement("th");$(th).append(B[U]);$(tr).append(th)}$(thead).append(tr);$(G).append(thead);tr=document.createElement("tr");td=document.createElement("td");if(!this.mOpts.magicSelect){if(0==D){$(td).append('<a href="javascript:void(0);" id="'+this.nextMonth+'"><i class="i_next"></i></a>')}if(D+1==this.mOpts.calendars){$(td).append('<a href="javascript:void(0);" id="'+this.preMonth+'"><i class="i_pre"></i></a>')}}$(td).attr("colSpan",7);$(td).css("text-align","center");$(tr).append(td);$(G).append(tr)}else{G.className=this.mOpts.theme+"_"+this.mOpts.dateTable;tr=document.createElement("tr");td=document.createElement("td");if(0==D){$(td).append('<a href="javascript:void(0);" id="'+this.nextMonth+'" class="gri_dateRangeNextMonth"><span>next</span></a>')}if(D+1==this.mOpts.calendars){$(td).append('<a href="javascript:void(0);" id="'+this.preMonth+'" class="gri_dateRangePreMonth"><span>pre</span></a>')}$(td).append(O+"年"+(V+1)+"月");$(td).attr("colSpan",7);$(td).css("text-align","center");$(td).css("background-color","#F9F9F9");$(tr).append(td);$(G).append(tr);var B=["日","一","二","三","四","五","六"];tr=document.createElement("tr");for(var U=0;U<7;U++){td=document.createElement("td");$(td).append(B[U]);$(tr).append(td)}$(G).append(tr)}var F="",X=0,S="";for(var N=W;N.getTime()<=I.getTime();N.setDate(N.getDate()+1)){if(N.getTime()<H.getTime()){F=this.mOpts.theme+"_"+this.mOpts.disableGray;X="-1"}else{if(N.getTime()>E.getTime()){F=this.mOpts.theme+"_"+this.mOpts.disableGray;X="1"}else{if((this.mOpts.stopToday==true&&N.getTime()>T.getTime())||N.getTime()<P.mOpts.minValidDate*1000||(""!==P.mOpts.maxValidDate&&N.getTime()>P.mOpts.maxValidDate*1000)){F=this.mOpts.theme+"_"+this.mOpts.disableGray;X="2"}else{X="0";if(N.getDate()==L&&N.getMonth()==M&&N.getFullYear()==Q){if(true==this.mOpts.isTodayValid){F=this.mOpts.theme+"_"+this.mOpts.isToday}else{F=this.mOpts.theme+"_"+this.mOpts.disableGray;X="2"}}else{F=""}if(this.mOpts.weekendDis&&(N.getDay()==6||N.getDay()==0)){F=this.mOpts.theme+"_"+this.mOpts.disableGray;X="3"}if(this.mOpts.disCertainDay&&this.mOpts.disCertainDay.length>0){for(var A in this.mOpts.disCertainDay){if(!isNaN(this.mOpts.disCertainDay[A])&&N.getDay()===this.mOpts.disCertainDay[A]){F=this.mOpts.theme+"_"+this.mOpts.disableGray;X="4"}}}if(this.mOpts.disCertainDate&&this.mOpts.disCertainDate.length>0){var J=false;for(var A in this.mOpts.disCertainDate){if(!isNaN(this.mOpts.disCertainDate[A])||isNaN(parseInt(this.mOpts.disCertainDate[A]))){if(this.mOpts.disCertainDate[0]===true){J=!!(N.getDate()!==this.mOpts.disCertainDate[A]);if(!J){break}}else{J=!!(N.getDate()===this.mOpts.disCertainDate[A]);if(J){break}}}}if(J){F=this.mOpts.theme+"_"+this.mOpts.disableGray;X="4"}}}}}if(0==N.getDay()){tr=document.createElement("tr")}td=document.createElement("td");td.innerHTML=N.getDate();if(""!=F){$(td).attr("class",F)}if(0==X){S=N.getFullYear()+"-"+(N.getMonth()+1)+"-"+N.getDate();$(td).attr("id",P.calendarId+"_"+S);$(td).css("cursor","pointer");(function(Z){$(td).bind("click",Z,function(){P.selectDate(Z);return false})})(S)}$(tr).append(td);if(6==N.getDay()){$(G).append(tr)}}return G};pickerDateRange.prototype.str2date=function(A){var B=A.split("-");return new Date(B[0],B[1]-1,B[2])};pickerDateRange.prototype.compareStrDate=function(C,A){var B=this.str2date(C);var D=this.str2date(A);if(B.getTime()>D.getTime()){return 1}else{if(B.getTime()==D.getTime()){return 0}else{return -1}}};pickerDateRange.prototype.date2ymd=function(A){return[A.getFullYear(),(A.getMonth()+1),A.getDate()]};pickerDateRange.prototype.changeInput=function(B){if(true==this.mOpts.isSingleDay){B=this.startDateId}var D=[this.startDateId,this.startCompareDateId,this.endDateId,this.endCompareDateId];var C="";if(B==this.startDateId||B==this.endDateId){C=this.mOpts.theme+"_"+this.mOpts.selectCss}else{C=this.mOpts.theme+"_"+this.mOpts.compareCss}if(B==this.endDateId&&this.mOpts.singleCompare){C=this.mOpts.theme+"_"+this.mOpts.compareCss}for(var A in D){$("#"+D[A]).removeClass(this.mOpts.theme+"_"+this.mOpts.selectCss);$("#"+D[A]).removeClass(this.mOpts.theme+"_"+this.mOpts.compareCss)}$("#"+B).addClass(C);$("#"+B).css("background-repeat","repeat");this.dateInput=B};pickerDateRange.prototype.formatDate=function(A){return A.replace(/(\d{4})\-(\d{1,2})\-(\d{1,2})/g,function(D,E,C,B){if(C<10){C="0"+C}if(B<10){B="0"+B}return E+"-"+C+"-"+B})};