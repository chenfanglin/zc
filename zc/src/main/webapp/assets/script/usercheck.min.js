$(function(){initPages();bindEvent()});function initPages(){initDateSelect();var B=$(window).height()-120;var A=false;if($(window).width()<=768){A=true}$("#checkUsers").bootstrapTable({cardView:A,undefinedText:"",cache:false,height:B,striped:true,pagination:true,pageSize:100,pageList:[10,25,50,100,200],sidePagination:"server",onPageChange:function(D,C){var E=$("#checkUsers").bootstrapTable("getOptions");var F=E.sortName;var G=E.sortOrder;getData(D,C,F,G)},onSort:function(E,F){var D=$("#checkUsers").bootstrapTable("getOptions");var G=D.pageNumber;var C=D.pageSize;getData(G,C,E,F)},rowStyle:function(C,D){if(D%2==0){return{classes:"odd_row"}}else{return{classes:"even_row"}}}});getData(1,50)}function getData(H,F,A,G,I){var D=dateRange.getCurrentDate().startDate;var B=dateRange.getCurrentDate().endDate;var E=$("#dropdownBtn").find("input").val();var C={"startDate":D,"endDate":B,"status":E,"pageNumber":H,"pageSize":F,"sortName":A,"order":G,"keyValue":I};$("#checkUsers").bootstrapTable("showLoading");$.ajax({url:"queryPtloginUserlist.do",data:{"queryParam":JSON.stringify(C)},method:"post",async:true,success:function(K){if(K.statusCode==504){$.messager.popup("系统错误，错误代码504。")}else{var J={total:K.content.totalRecord,rows:K.content.checkUsers};$("#checkUsers").bootstrapTable("hideLoading");$("#checkUsers").bootstrapTable("load",J);addActiveClass()}}})}function bindEvent(){$("#confirm").click(function(A){query()});$("#checkPtlogin").click(function(){auditPtloginUser()});$("#searchUsers").off("keyup drop").on("keyup drop",function(B){if(B.keyCode=="13"){var A=$("#searchUsers").val();keySearch(A)}});window.checkEvents={"click button":function(A,D,C,B){openCheck(C)}};$("input[name=checkRadios]").click(function(){toggleRadio()});$("#btnMenu").click(function(A){queryByMenu(A)});$("#ipbtn").click(function(){iPAuthorize()})}function auditPtloginUser(){var A={"uid":$("#inputUID").val(),"type":$('input[name="checkRadios"]:checked ').val(),"reason":$("#reasonText").val(),"business":$("#businessSelect").val(),"businessName":$("#businessSelect").find("option:selected").text()};$.ajax({url:"auditPtloginUser.do",data:{"checkParam":JSON.stringify(A)},method:"post",async:true,success:function(E){if(E.statusCode==200){$.messager.popup("操作成功")}else{if(E.statusCode==10){$.messager.popup("邮件发送失败")}else{if(E.statusCode==504){$.messager.popup("系统错误，错误代码504。")}else{if(E.statusCode==6){$.messager.popup("用户不存在")}else{if(E.statusCode==4){window.open("login.jsp")}}}}}var B=$("#checkUsers").bootstrapTable("getOptions");var C=B.sortName;var D=B.sortOrder;getData(1,50,C,D);$("#docheck").modal("hide")}})}function keySearch(B){var A=$("#checkUsers").bootstrapTable("getOptions");var C=A.sortName;var D=A.sortOrder;getData(1,50,C,D,B)}function openCheck(A){initSelectbox($("#businessSelect"),"3",1,0);$("#inputUID").val(A.uid);$("#docheck").modal({backdrop:"static",keyboard:false})}function toggleRadio(){var A=$('input[name="checkRadios"]:checked ').val();if(A==2){$("#reasonText").attr("disabled","true");$("#businessSelect").removeAttr("disabled")}else{if(A==1){$("#reasonText").removeAttr("disabled");$("#businessSelect").attr("disabled","true")}}}function queryByMenu(A){var C=$(A.target).text();var B=$(A.target).find("input").val();$("#dropdownBtn").text(C).append('<span class="caret"><input type="hidden" value="'+B+'"/>');query()}function query(){getData(1,50)}function iPAuthorize(){$.ajax({url:"getIP.do",method:"post",async:true,success:function(A){if(A.statusCode==200){$.messager.popup("授权成功，您的IP："+A.content)}else{if(A.statusCode==403){$.messager.popup("您没有操作权限，请联系系统管理员")}else{if(A.statusCode==504){$.messager.popup("系统错误，错误代码504。")}else{if(A.statusCode==4){window.open("login.jsp")}}}}}})};