$(function(){initPages();bindEvent()});function initPages(){var A=$(window).height()-120;$("#userList").bootstrapTable({undefinedText:"",cache:false,height:A,striped:true,pagination:true,pageSize:50,pageList:[10,25,50,100,200],sidePagination:"server",search:true,showColumns:true,showRefresh:true,showToggle:true,onPageChange:function(C,B){getData(C,B)},onSort:function(B,C){getData(1,50)},onSearch:function(B){getData(1,50)},rowStyle:function(B,C){if(C%2==0){return{classes:"odd_row"}}else{return{classes:"even_row"}}}});getData(1,50)}function getData(B,A){var C={"pageNumber":B,"pageSize":A};$("#userList").bootstrapTable("showLoading");$.ajax({url:"getPersons.do",data:{"queryParam":JSON.stringify(C)},method:"post",async:true,success:function(E){if(E.statusCode==504){$.messager.popup("系统错误，错误代码504。")}else{var D={total:E.content.totalRecord,rows:E.content.users};$("#userList").bootstrapTable("hideLoading");$("#userList").bootstrapTable("load",D);addActiveClass()}}})}function bindEvent(){window.operateEvents={"click .edit":function(A,D,C,B){openEditModal(C)},"click .remove":function(A,D,C,B){delCompanyUser(C)}};$("#updatePerson").click(function(){updatePerson()});$("#checkall").click(function(){if($("#checkall")[0].checked==true){$("input[name='mainmenu']").each(function(){this.checked=true;$("input[name='"+this.value+"']").each(function(){this.checked=true})})}else{$("input[name='mainmenu']").each(function(){this.checked=false;$("input[name='"+this.value+"']").each(function(){this.checked=false})})}})}function openEditModal(A){$("#inputpersonID").val(A.personID);$("#inputloginEmail").val(A.loginName);$("#inputpersonName").val(A.personName);$("#inputenglishName").val(A.englishName);$("#inputtelNumber").val(A.telNumber);initSelectbox($("#accountSelect"),"10001021",0);$("#accountSelect").val(A.roleType);initSelectByURL($("#departmentSelect"),"getDepartMent.do");$("#departmentSelect").val(A.department);$("#editUser").modal()}function updatePerson(){var A={"personID":$("#inputpersonID").val(),"personName":$("#inputpersonName").val(),"loginName":$("#inputloginEmail").val(),"englishName":$("#inputenglishName").val(),"department":$("#departmentSelect").val(),"telNumber":$("#inputtelNumber").val(),"roleType":$("#accountSelect").val()};$.ajax({url:"savePersons.do",data:{"user":JSON.stringify(A)},method:"post",async:true,success:function(B){if(B.statusCode==504){$.messager.popup("系统错误，错误代码504。")}else{if(B.statusCode==4){window.open("login.jsp")}else{$.messager.popup("修改成功");$("#editUser").modal("hide");refreshTable($("#userList"))}}}})}function checkchild(A){if($("#"+A+"")[0].checked==true){$("input[name='"+A+"']").each(function(){this.checked=true})}else{$("input[name='"+A+"']").each(function(){this.checked=false})}}function delCompanyUser(A){$.messager.confirm("","确定删除该条员工信息？",function(){$.ajax({url:"delPersons.do",data:{"personID":A.personID},method:"post",async:true,success:function(B){if(B.statusCode==504){$.messager.popup("系统错误，错误代码504。")}else{if(B.statusCode==4){window.open("login.jsp")}else{$.messager.popup("删除成功");refreshTable($("#userList"))}}}})})};